# Public Exploits: WordPress 5.6.1 Exploitation CTF

**Date Started:** January 24, 2026  
**Date Completed:** January 25, 2026  
**Status:** âœ… FLAG CAPTURED  
**Flag:** `HTB{my_f1r57_h4ck}`

---

## ğŸ“Š Quick Summary

| Aspect | Details |
|--------|---------|
| **Target IP** | 83.136.251.105:35361 |
| **CMS** | WordPress 5.6.1 |
| **Vulnerable Plugin** | Simple Backup Plugin v2.7.10 |
| **Vulnerability Type** | Arbitrary File Read (AFR) |
| **CVE** | CVE-2019-8943 / CVE-2019-8944 |
| **Authentication Required** | None (Unauthenticated) |
| **Exploit Module** | scanner/http/wp_simple_backup_file_read |
| **Time to Flag** | ~80 minutes |
| **Exploitation Method** | Metasploit Scanner Module |

---

## ğŸ¯ Complete Exploitation Workflow

### PHASE 1: SERVICE ENUMERATION & RECONNAISSANCE

**Objective:** Verify network connectivity and identify open services

**Command 1: Nmap Service Enumeration**
```bash
nmap -sS -sV -p 35361 83.136.251.105
```

**Results:**
- âœ… Port 35361 OPEN
- âœ… Service: HTTP
- âœ… Web Server: Apache httpd 2.4.41 (Ubuntu)
- âœ… Network connectivity confirmed to HTB VPN

**Key Information:**
- Apache version 2.4.41 suggests Ubuntu system
- Need to check for actual web application vulnerabilities
- Service is accessible and responding

**Why This Matters:**
- Confirms VPN connection is working
- Verifies target is reachable and responsive
- Identifies correct port and service for web enumeration

---

**Command 2: Banner Grabbing**
```bash
curl -IL http://83.136.251.105:35361/
```

**Results:**
- âœ… HTTP Status: 200 OK (service responding normally)
- âœ… Server: Apache/2.4.41 (Ubuntu)
- âœ… No redirects (direct access to application)

**Why This Matters:**
- Safe way to gather info without full page visit
- Reveals HTTP headers and server configuration
- No browser tracking or JavaScript execution
- Confirms application is running at this exact address

---

### PHASE 2: TECHNOLOGY FINGERPRINTING

**Command: WhatWeb Technology Detection**
```bash
whatweb http://83.136.251.105:35361/
```

**Results:**
- âœ… Site Name: "just another wordpress site"
- âœ… CMS: WordPress
- âœ… Version: 5.6.1 (Old, vulnerable version!)
- âœ… Server: Apache 2.4.41 (Ubuntu)
- âœ… Technology Stack: HTML5, no other frameworks detected

**CRITICAL DISCOVERY:**
- âŒ Apache 2.4.41 is NOT the vulnerability target
- âœ… WordPress 5.6.1 IS the real vulnerability vector
- Version 5.6.1 is from 2020/2021 era - old and vulnerable

**Strategic Analysis:**
Earlier mistake: We initially searched for Apache 2.4.41 exploits
Result: âŒ ZERO exploits found
Lesson: Service version â‰  vulnerability. Need to find actual installed software!

---

### PHASE 3: MANUAL WEBSITE ANALYSIS (CRITICAL!)

**Objective:** Identify installed plugins and specific vulnerable components

**Step: Manual Website Visit**
```
URL: http://83.136.251.105:35361/
Method: Open in web browser
```

**Critical Discovery:**
- âœ… WordPress blog post announcing recent plugin update
- âœ… **Plugin Name:** Simple Backup Plugin
- âœ… **Plugin Version:** 2.7.10
- âœ… Specific version number identified!

**Why Manual Analysis is CRITICAL:**
- Automated tools often miss developer announcements
- Blog posts explicitly mention installed plugins
- Version numbers enable precise CVE research
- This is the difference between success and failure!

**Key Lesson:** 
Don't skip manual website inspection! Even basic browsing reveals plugin versions that automated scanning might miss.

---

### PHASE 4: VULNERABILITY RESEARCH

**Command: SearchSploit for Simple Backup Plugin**
```bash
searchsploit simple backup 2.7.10
```

**Results Found:**
- âœ… Simple Backup Plugin 2.7.10 - Arbitrary File Read (AFR)
- âœ… Vulnerability Type: Unauthenticated File Disclosure
- âœ… CWE-434: Unrestricted Upload of File with Dangerous Type
- âœ… Public exploit available
- âœ… SEVERITY: Critical (CVSS 9.1+)

**Vulnerability Details:**
- Creates backup archives in web-accessible directory
- No authentication required to access backups
- No input validation on file paths (directory traversal possible)
- Allows reading ARBITRARY FILES from server filesystem
- Backup files stored at: `/wp-content/plugins/simple-backup/backups/`

**Key Learning:**
Always consult SearchSploit BEFORE Metasploit to:
1. Understand the vulnerability class
2. Confirm it's actually exploitable
3. Learn CVE details and methodology

---

### PHASE 5: EXPLOIT SEARCH & SELECTION

**Command: Search Metasploit for WordPress exploits**
```bash
msf6 > search wordpress
```

**Initial Attempts Found Multiple Exploits:**

**Exploit 1: Elementor King Addons Privilege Escalation**
```
Exploit: exploit/multi/http/wp_king_addons_priveledge_escalation
Rank: âœ… EXCELLENT
Type: Unauthenticated Privilege Escalation â†’ RCE
Check Result: âœ… YES (Verified vulnerable!)
Required: USERNAME, PASSWORD, NONCE_PAGE, EMAIL, RHOSTS, RPORT, TARGETURI
Complexity: MEDIUM-HIGH
Issue: Requires WordPress credentials (don't have them)
```

**Exploit 2: GiveWP Plugin RCE**
```
Exploit: exploit/multi/http/wp_givewp_rce
Rank: âœ… EXCELLENT
Type: Unauthenticated Remote Code Execution
Required: RHOSTS, RPORT, TARGETURI, PAYLOAD, LHOST, LPORT
Complexity: LOW-MEDIUM
Issue: GiveWP plugin not installed on target (exploit failed)
```

**Exploit 3: ACF Extended RCE**
```
Exploit: exploit/multi/http/wp_acf_extended_rce
Rank: âœ… EXCELLENT
Type: Unauthenticated RCE
Required: USERNAME, PASSWORD (other credentials)
Complexity: MEDIUM-HIGH
Issue: Requires credentials
```

**Strategic Pivot Decision:**
âŒ Elementor, GiveWP, ACF exploits required credentials or weren't installed
âœ… Need to find simpler unauthenticated exploit

**Lesson Learned:**
Service identification â‰  vulnerability identification. Many WordPress exploits don't work on arbitrary targets if their plugins aren't installed.

---

### PHASE 6: SIMPLE BACKUP PLUGIN EXPLOITATION

**Command: Search for Simple Backup in Metasploit**
```bash
msf6 > search wordpress simple backup
```

**Results:**
- âœ… Found: `scanner/http/wp_simple_backup_file_read`
- âœ… Type: Scanner (non-destructive)
- âœ… Rank: Excellent
- âœ… Required Options: RHOSTS, RPORT, FILEPATH
- âœ… Does NOT require authentication
- âœ… PERFECT MATCH!

**Why This Exploit is Ideal:**
1. âœ… Unauthenticated (no credentials needed)
2. âœ… Minimal configuration (only 3 required options)
3. âœ… Non-destructive scanner module
4. âœ… Perfect for vulnerability verification
5. âœ… Direct file reading without RCE

---

**Step 1: Load Metasploit Module**
```bash
msfconsole
msf6 > use scanner/http/wp_simple_backup_file_read
msf6 scanner(http/wp_simple_backup_file_read) >
```

**Step 2: Configure for Verification Test**
```bash
msf6 scanner(...) > set RHOSTS 83.136.251.105
msf6 scanner(...) > set RPORT 35361
msf6 scanner(...) > set FILEPATH /etc/passwd
msf6 scanner(...) > show options
```

**Configuration (Verification Stage):**
```
RHOSTS       83.136.251.105  âœ… Target IP
RPORT        35361           âœ… Target Port
FILEPATH     /etc/passwd     âœ… Safe test file
```

---

**Step 3: Execute Scanner (Verification)**
```bash
msf6 scanner(...) > run
```

**Results:**
- âœ… File Retrieved: `/etc/passwd`
- âœ… Content: Valid Linux user account information
- âœ… Vulnerability CONFIRMED: Arbitrary file read is working!

**Why Two-Stage Exploitation:**
1. **Stage 1 (Verification):** Test on `/etc/passwd`
   - Confirms vulnerability exists
   - Verifies scanner configuration is correct
   - Low risk (system file, not sensitive data)
   - Builds confidence before flag attempt

2. **Stage 2 (Target):** Extract `/flag.txt`
   - Confident technique will work
   - Reduced risk of misconfiguration
   - Ready to capture actual objective

---

### PHASE 7: FLAG CAPTURE

**Step 1: Reconfigure for Flag**
```bash
msf6 scanner(...) > set FILEPATH /flag.txt
```

**Updated Configuration:**
```
RHOSTS       83.136.251.105  âœ… Target IP
RPORT        35361           âœ… Target Port
FILEPATH     /flag.txt       âœ… TARGET FILE
```

---

**Step 2: Execute Scanner (Flag Extraction)**
```bash
msf6 scanner(...) > run
```

**Results:**
```
[+] File Retrieved: /flag.txt
[+] Content:
HTB{my_f1r57_h4ck}
```

**Status:** âœ… **FLAG SUCCESSFULLY CAPTURED**

---

## ğŸ” How the Vulnerability Works

### Technical Breakdown

**Vulnerability Chain:**

1. **Simple Backup Plugin creates backup archives**
   - Stores application backups on server
   - Backups include database, files, configuration
   - Located in: `/wp-content/plugins/simple-backup/backups/`

2. **Backup files stored in web-accessible directory**
   - Backups are created with HTTP-readable permissions
   - Accessible via direct HTTP requests
   - No authentication checks on backup directory

3. **No authentication required**
   - Plugin doesn't validate user permissions
   - Backup access doesn't check login status
   - Anyone with network access can retrieve backups

4. **No file path validation**
   - FILEPATH parameter not properly sanitized
   - Allows directory traversal sequences (`../../`)
   - Can read ANY file from server filesystem
   - Not just backup files - arbitrary file read!

5. **Scanner reads arbitrary files**
   - Exploits directory traversal vulnerability
   - Extracts file contents directly from filesystem
   - No reverse shell needed
   - Direct data extraction

6. **Flag file accessible**
   - Placed at `/flag.txt` in web root (CTF setup)
   - Readable by web server process
   - Successfully extracted via scanner

---

## ğŸ“ˆ Attack Timeline & Lessons

### What Worked Well âœ…

1. **Manual Website Inspection** â†’ Found plugin version (2.7.10)
2. **SearchSploit Research** â†’ Located CVE and confirmed vulnerability exists
3. **Scanner Module Selection** â†’ Chose non-destructive testing approach
4. **Two-Stage Verification** â†’ Tested on safe file first (/etc/passwd)
5. **Strategic Configuration** â†’ Simple RHOSTS, RPORT, FILEPATH setup
6. **Complete Documentation** â†’ All findings recorded for learning

### Mistakes from Earlier Attempts âŒ

**Mistake 1: Version-Specific Metasploit Searches**
```bash
# âŒ WRONG:
search wordpress 5.6.1
# Returns: Zero results (version too specific)

# âœ… CORRECT:
search wordpress
# Then identify specific installed plugins manually
```

**Lesson:** Metasploit doesn't index by minor version. Must search for actual installed components (plugins).

---

**Mistake 2: Assuming Service = Vulnerability**
- Searched for Apache 2.4.41 exploits â†’ Found nothing
- Assumed Apache was vulnerable â†’ It wasn't
- Real vulnerability was in WordPress plugins
- **Lesson:** Service version â‰  vulnerability. Enumerate actual components!

---

**Mistake 3: Ignoring Manual Website Inspection**
- Earlier attempts: Only used automated tools
- This machine: Manually browsed website
- **Result:** Found Simple Backup Plugin announcement in blog post!
- **Lesson:** Automated tools miss what humans see. Always manually inspect!

---

**Mistake 4: Skipping Plugin Enumeration**
- Tried Elementor and GiveWP exploits without verifying they were installed
- Exploits failed because plugins didn't exist on target
- Should have enumerated `/wp-content/plugins/` first
- **Lesson:** Verify plugins exist before searching for exploits

---

**Mistake 5: Prioritizing Complex Exploits**
- Started with Elementor (requires credentials)
- Switched to GiveWP (assumed unauthenticated)
- Finally found Simple Backup (actually present)
- **Lesson:** Prioritize simple exploits with fewest options first

---

## ğŸ’¡ Key Learning Insights

### 1. Manual Analysis > Automated Scanning
The Simple Backup Plugin version was discovered by:
- âœ… Manually visiting the website
- âœ… Reading the blog post
- âŒ NOT found by WhatWeb or automated tools

**Insight:** Humans see what tools miss. Always manually inspect target websites.

---

### 2. Scanner Modules are Powerful â­
- Scanner modules are non-destructive
- Perfect for vulnerability verification
- Can achieve results without reverse shells
- Safer for initial testing than RCE exploits
- Better for direct data extraction

**Insight:** Not every exploitation needs RCE. File read = data compromise.

---

### 3. Two-Stage Exploitation Reduces Risk â­
- Stage 1: Verify vulnerability with safe file (`/etc/passwd`)
- Stage 2: Extract actual target (`/flag.txt`)
- Benefits:
  - Builds confidence in technique
  - Catches misconfiguration early
  - Reduces wasted attempts

**Insight:** Verify before exploiting. Save risky moves for last.

---

### 4. Plugin Enumeration is Critical â­
- Should enumerate `/wp-content/plugins/` early
- Different targets have different plugins installed
- Exploits only work if plugins are present
- Version numbers enable precise CVE research

**Insight:** Know your target before searching for exploits.

---

### 5. SearchSploit Before Metasploit
- SearchSploit provides vulnerability understanding
- Confirms exploit exists and is exploitable
- Shows CVE details and methodology
- Saves time vs. browsing Metasploit
- Public exploits reveal attack techniques

**Insight:** Understand vulnerability class before loading exploit.

---

### 6. Arbitrary File Read = RCE Equivalent â­
- File read as valuable as Remote Code Execution
- Can extract configuration files with credentials
- Can read source code with hardcoded secrets
- Can access sensitive data files
- Sometimes simpler to exploit than RCE

**Insight:** Data theft doesn't always need command execution.

---

## ğŸ“ Skills Demonstrated

âœ… Network reconnaissance (nmap)  
âœ… Service identification (curl, HTTP headers)  
âœ… Manual website analysis and plugin discovery  
âœ… Plugin vulnerability research (SearchSploit)  
âœ… CVE database searching  
âœ… Metasploit framework navigation  
âœ… Scanner module configuration and execution  
âœ… Vulnerability verification technique (two-stage)  
âœ… Strategic exploit selection  
âœ… File system access exploitation  
âœ… Risk assessment and safe testing practices  
âœ… Complete documentation and analysis  
âœ… Real-world decision-making (strategic pivoting)  

---

## ğŸ“š WordPress Plugin Exploitation Checklist

For future WordPress targets, follow this process:

- [ ] **Step 1:** Manual website visit (find plugin announcements)
- [ ] **Step 2:** Identify specific plugin names and versions
- [ ] **Step 3:** SearchSploit: `searchsploit [plugin-name] [version]`
- [ ] **Step 4:** Identify vulnerability type (RCE, SQLi, AFR, LFI)
- [ ] **Step 5:** Check authentication requirements
- [ ] **Step 6:** If no credentials: Prioritize unauthenticated exploits
- [ ] **Step 7:** Metasploit: `search [plugin-name]`
- [ ] **Step 8:** Look for scanner modules first (safer)
- [ ] **Step 9:** Configure RHOSTS, RPORT, other required options
- [ ] **Step 10:** Test with safe file first (e.g., /etc/passwd)
- [ ] **Step 11:** If safe file works, extract actual target

---

## ğŸ¯ Conclusion

**Challenge:** Compromise WordPress 5.6.1 and capture flag  
**Solution:** Manual analysis â†’ Plugin discovery â†’ CVE research â†’ Metasploit scanner â†’ Two-stage verification â†’ Flag capture

**Result:** âœ… Flag captured: `HTB{my_f1r57_h4ck}`

**Key Insight:** Manual website inspection proved more valuable than automated scanning. Developer announcements about Simple Backup Plugin v2.7.10 enabled targeted exploitation.

**Time Investment:** 80 minutes total  
**Learning Value:** â­â­â­â­â­ Excellent  

**Overall Assessment:** Excellent learning session demonstrating:
- Importance of manual reconnaissance
- Strategic tool selection and usage
- Safe verification techniques before full exploitation
- Real-world decision-making and adaptation
- Complete documentation practices

---

## ğŸ“ Next Steps

1. âœ… Complete additional Very Easy HTB boxes
2. âœ… Practice scanner module techniques on other targets
3. âœ… Build WordPress plugin vulnerability knowledge base
4. âœ… Document other common WordPress plugin vulnerabilities
5. âœ… Move to Easy-level boxes with similar methodology

---

**Session Status:** âœ… EXPLOITATION COMPLETE - FLAG CAPTURED  
**Date Completed:** January 25, 2026  
**Ready for Next Box:** Yes âœ…
